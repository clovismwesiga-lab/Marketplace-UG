<!DOCTYPE html>
<html>
<head>
  <title>Admin Approval</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
<div class="card">
  <h2>Pending Approvals</h2>
  <div id="pending"></div>
</div>

<script type="module" src="firebase-init.js"></script>
<script type="module">
  import { db } from "./firebase-init.js";
  import { collection, getDocs, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  async function loadPending() {
    let area = document.getElementById("pending");
    let items = await getDocs(collection(db, "listings"));

    items.forEach(d => {
      let item = d.data();
      if (!item.approved) {
        area.innerHTML += `
          <div class="card">
            <h3>${item.title}</h3>
            <p>UGX ${item.price}</p>
            <button onclick="approve('${d.id}')">Approve</button>
          </div>
        `;
      }
    });
  }

  loadPending();

  window.approve = async (id) => {
    await updateDoc(doc(db, "listings", id), { approved: true });
    alert("Approved!");
    location.reload();
  };
</script>

</body>
</html>
